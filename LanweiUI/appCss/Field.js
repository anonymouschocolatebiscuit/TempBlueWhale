require({cache:{"app/vm/field/FieldList":function(){define("dojo/_base/declare dijit/_TemplatedMixin dojo/text!./tpl/field_list.html app/util/_WidgetBase app/vm/field/FieldPanel dojo/dom-construct dojo/dom-attr dojo/_base/lang dojo/_base/array dojo/on dojo/Evented dijit/registry dojo/dom-style dijit/_Container dijit/_Contained".split(" "),function(g,k,a,h,l,m,e,f,c,p,q,r,s,n,d){return g("app.vm.FieldList",[h,k,n,d],{templateString:a,currentTab:null,currentLabel:null,panelWidgetId:null,fieldData:null,
postCreate:function(){this.inherited(arguments)},init:function(){var b;this.panelWidgetId?"defaultView"==this.panelWidgetId?b=this.defaultNode:"customView"==this.panelWidgetId?b=this.customNode:"disableView"==this.panelWidgetId&&(b=this.disableNode):(this.panelWidgetId="defaultView",b=this.defaultNode);this.changeTab(this.panelWidgetId,b);this._initEvent()},_initEvent:function(){},changeTab:function(b,d){var a={id:b,fieldData:this.fieldData};"customView"==b?(f.mixin(a,{supportAdd:!0}),this.viewIntroNode.innerHTML=
"\u7ba1\u7406\u5458\u53ef\u4ee5\u6839\u636e\u4f01\u4e1a\u9700\u8981\uff0c\u6dfb\u52a0\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u5b57\u6bb5\uff0c\u5305\u62ec\u6587\u672c\u3001\u6574\u6570\u578b\u3001\u65e5\u671f\u3001\u5355\u9009\u679a\u4e3e\u578b\u5b57\u6bb5"):"defaultView"==b&&(this.viewIntroNode.innerHTML="\u7ba1\u7406\u5458\u53ef\u4ee5\u6839\u636e\u4f01\u4e1a\u9700\u8981\uff0c\u4fee\u6539\u9ed8\u8ba4\u5b57\u6bb5\u7684\u663e\u793a\u540d\u79f0\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u679a\u4e3e\u578b\u5b57\u6bb5\u7684\u679a\u4e3e\u503c");
this.currentLabel&&this.removeClass(this.currentLabel,"current");this.currentLabel=d;this.addClass(d,"current");this.currentTab&&(this.currentTab.domNode.style.display="none");var n=r.byId(b);n?(n.domNode.style.display="block",this.currentTab=n,this.currentTab.fieldData=this.fieldData,this.currentTab.init()):(this.currentTab=new l(a),this.own(p(this.currentTab,"detail",f.hitch(this,function(b){this.emit("detail",b)}))),this.addChild(this.currentTab))}})})},"app/vm/field/FieldPanel":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin app/util/_WidgetBase dojo/dom-construct dojo/_base/lang dojo/_base/array dojo/on dojo/Evented dijit/form/Textarea dijit/registry dijit/_Container dijit/_Contained dojo/dom-style dojo/dom-class".split(" "),
function(g,k,a,h,l,m,e,f,c,p,q,r,s,n,d){var b=g("app.vm.FieldNode",[k,a],{templateString:"\x3cdiv  class\x3d'fieldLabelNode ${cls}'\x3e\x3cspan class\x3d'icon'\x3e\x3ci\x3e\x3c/i\x3e\x3c/span\x3e\x3cspan class\x3d'label' data-dojo-attach-point\x3d'contentpane'\x3e\x3c/span\x3e\x3cdiv\x3e(${type})\x3c/div\x3e\x3c/div\x3e",fieldPanelType:null,item:null,map:{Enum:"\u679a\u4e3e",Date:"\u65e5\u671f",Integer:"\u6574\u6570"},postMixInProperties:function(){var b=this.item;this.type=this.map[b.type]||"\u6587\u672c";
this.cls=b.ziDingYi?"":" disabled"},postCreate:function(){var b=this.item;this.contentpane.innerHTML=b.label;this.domNode.title=b.label;d.add(this.domNode,this.fieldPanelType)}}),t=g("app.vm.FieldWidget",[h,a,r,s,c],{templateString:'\x3cdiv class\x3d"field clear"\x3e\x3cdiv class\x3d"top"\x3e\x3cspan class\x3d"label"\x3e${title}\x3c/span\x3e\x3cspan class\x3d"addFieldBtn" data-dojo-attach-point\x3d"addFieldBtnNode"\x3e\x3ci class\x3d"addIcon"\x3e\x3c/i\x3e\x3ci\x3e\u6dfb\u52a0\u5b57\u6bb5\x3c/i\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"line"\x3e\x3ci\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"content fieldListCont clearfix" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
fieldPanelType:"",fieldNodeList:null,fieldData:null,supportAdd:null,url:"",title:"",parentId:null,postMixInProperties:function(){"Customer"==this.fieldPanelType?this.title="\u5ba2\u6237\u5b57\u6bb5":"Contact"==this.fieldPanelType?this.title="\u8054\u7cfb\u4eba\u5b57\u6bb5":"WorkRecord"==this.fieldPanelType&&(this.title="\u5de5\u4f5c\u8bb0\u5f55\u5b57\u6bb5")},postCreate:function(){this.addClass(this.addFieldBtnNode,this.fieldPanelType);this.supportAdd&&d.remove(this.addFieldBtnNode,"hide");"WorkRecord"==
this.fieldPanelType&&core.destroy(this.addFieldBtnNode);this.fieldNodeList=[];this._initEvent()},init:function(){for(var b=0,d=this.fieldNodeList.length;b<d;b++)this.fieldNodeList.pop().destroy();this.buildFieldPanel()},_initEvent:function(){var b=this;this.own(f(this.domNode,f.selector(".fieldLabelNode","click"),function(d){b._onShowDetail(q.byNode(this),d)}),f(this.addFieldBtnNode,"click",function(d){b._onShowDetail(b.fieldPanelType,d)}))},buildFieldPanel:function(){var b=null;"defaultView"==this.parentId?
b=this.fieldData[this.fieldPanelType].fields:"customView"==this.parentId&&(b=this.fieldData[this.fieldPanelType].customFields);this.buildField(b,this.fieldPanelType)},buildField:function(d,n){var a=[],e=[],c;for(c in d)d[c].ziDingYi?e.push(d[c]):a.push(d[c]);a=a.concat(e);e=a.length;for(c=0;c<e;c++){var f=new b({item:a[c],fieldPanelType:n});this.fieldNodeList.push(f);this.addChild(f)}},_onShowDetail:function(b,d){this.emit("onShowDetail",b,d)}});return g("app.vm.FieldPanel",[k,a,r,s,c],{templateString:"\x3cdiv class\x3d'fieldPanel'\x3e\x3cdiv data-dojo-attach-point\x3d'containerNode'\x3e\x3c/div\x3e\x3c/div\x3e",
supportAdd:null,fieldData:null,postCreate:function(){this.inherited(arguments);this._initComps();this.init();this._initEvent()},init:function(){this.customerFieldWidget.fieldData=this.fieldData;this.customerFieldWidget.init();this.contactFieldWidget.fieldData=this.fieldData;this.contactFieldWidget.init();this.wrFieldWidget&&(this.wrFieldWidget.fieldData=this.fieldData,this.wrFieldWidget.init())},_initComps:function(){this.customerFieldWidget=new t({supportAdd:this.supportAdd,fieldData:this.fieldData,
fieldPanelType:"Customer",parentId:this.id});this.contactFieldWidget=new t({supportAdd:this.supportAdd,fieldData:this.fieldData,fieldPanelType:"Contact",parentId:this.id});this.addChild(this.customerFieldWidget);this.addChild(this.contactFieldWidget);"defaultView"==this.id&&(this.wrFieldWidget=new t({supportAdd:this.supportAdd,fieldData:this.fieldData,fieldPanelType:"WorkRecord",parentId:this.id}),this.addChild(this.wrFieldWidget))},_initEvent:function(){this.own(f(this.customerFieldWidget,"onShowDetail",
m.hitch(this,this.showDetail)),f(this.contactFieldWidget,"onShowDetail",m.hitch(this,this.showDetail)));this.wrFieldWidget&&this.own(f(this.wrFieldWidget,"onShowDetail",m.hitch(this,this.showDetail)))},showDetail:function(b,d){$("#conditionpanel").addClass("hide");$("#admin-header").addClass("hide");"string"==typeof b?this.emit("detail",{item:null,fieldEntityType:b,panelWidgetId:this.id}):this.emit("detail",{item:b.item,fieldEntityType:b.fieldPanelType,panelWidgetId:this.id})}})})},"dijit/form/Textarea":function(){define(["dojo/_base/declare",
"dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(g,k,a,h){return g("dijit.form.Textarea",[h,a],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);k.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),
function(g,k,a,h,l,m,e){a.add("textarea-needs-help-shrinking",function(){var a=m.body(),c=k.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},a,"last"),e=c.scrollHeight>=c.clientHeight;a.removeChild(c);return e});return g("dijit.form._ExpandingTextAreaMixin",
null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);var a=this.textbox;a.style.overflowY="hidden";this.own(l(a,"focus, resize",h.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);this.own(e.on("resize",h.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(a){this.inherited(arguments);this.resize()},_estimateHeight:function(){var a=this.textbox;a.rows=(a.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},
resize:function(){function e(){var b=!1;""===c.value&&(c.value=" ",b=!0);var d=c.scrollHeight;b&&(c.value="");return d}var c=this.textbox;"hidden"==c.style.overflowY&&(c.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(e()||c.offsetHeight){var h=e()+Math.max(c.offsetHeight-c.clientHeight,0),g=h+"px";g!=c.style.height&&(c.style.height=g,c.rows=1);if(a("textarea-needs-help-shrinking")){var k=e(),l=c.style.minHeight,n=4,d=c.scrollTop;c.style.minHeight=g;for(c.style.height="auto";0<h;){c.style.minHeight=
Math.max(h-n,4)+"px";g=e();k-=g;h-=k;if(k<n)break;k=g;n<<=1}c.style.height=h+"px";c.style.minHeight=l;c.scrollTop=d}c.style.overflowY=e()>c.clientHeight?"auto":"hidden";"hidden"==c.style.overflowY&&(c.scrollTop=0)}else this._estimateHeight();this.busyResizing=!1}}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(g,k,a,h){return g("dijit.form.SimpleTextarea",h,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);a("ie")&&this.cols&&k.add(this.textbox,"dijitTextAreaCols")},filter:function(a){a&&(a=a.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(h){if(this.maxLength){var g=parseInt(this.maxLength),e=this.textbox.value.replace(/\r/g,""),g=e.length-g;if(0<g){var f=this.textbox;if(f.selectionStart){var c=f.selectionStart,
k=0;a("opera")&&(k=(this.textbox.value.substring(0,c).match(/\r/g)||[]).length);this.textbox.value=e.substring(0,c-g-k)+e.substring(c-k);f.setSelectionRange(c-g,c-g)}else this.ownerDocument.selection&&(f.focus(),e=this.ownerDocument.selection.createRange(),e.moveStart("character",-g),e.text="",e.select())}}this.inherited(arguments)}})})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(g,k){return g("dijit._Contained",null,{_getSibling:function(a){var h=this.domNode;
do h=h[a+"Sibling"];while(h&&1!=h.nodeType);return h&&k.byNode(h)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var a=this.getParent();return!a||!a.getIndexOfChild?-1:a.getIndexOfChild(this)}})})},"app/vm/field/FieldDetail":function(){define("dojo/_base/declare dijit/_TemplatedMixin dojo/text!./tpl/field_detail.html app/util/_WidgetBase app/util/escape app/vm/field/FieldPanel dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/Evented dijit/form/Button chanjet/form/Tooltip app/vm/field/FieldEnumWidget csp/Page".split(" "),
function(g,k,a,h,l,m,e,f,c,p,q,r,s,n,d){var b=[{label:"\u6587\u672c",type:"Text",remark:"\u5141\u8bb8\u8f93\u5165\u4efb\u4f55\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u7b26\u53f7\u7684\u7ec4\u5408\uff0c\u6700\u591a\u53ef\u8f93\u516564\u4e2a\u5b57\u7b26"},{label:"\u6574\u6570",type:"Integer",remark:"\u53ea\u5141\u8bb8\u8f93\u5165\u6574\u6570\uff0c\u6700\u591a\u53ef\u8f93\u516516\u4f4d"},{label:"\u65e5\u671f",type:"Date",remark:"\u5141\u8bb8\u8f93\u5165\u65e5\u671f\u6216\u4ece\u5f39\u51fa\u5f0f\u65e5\u5386\u4e2d\u9009\u62e9\u65e5\u671f"},
{label:"\u5355\u9009\u679a\u4e3e",type:"Enum",remark:"\u5141\u8bb8\u4ece\u5b9a\u4e49\u7684\u5217\u8868\u4e2d\u9009\u62e9\u503c\uff0c\u9f20\u6807\u62d6\u52a8\u5217\u8868\u4e2d\u7684\x3cdiv class\x3d'drag-ii'\x3e\x3ca \x3e\x3c/a\x3e\x3c/div\x3e\u53ef\u5bf9\u679a\u4e3e\u503c\u6392\u5e8f"}];a=g("app.vm.FieldDetail",[h,k,q],{templateString:a,item:null,title:null,textRender:null,panelWidgetId:null,enumFieldWidget:null,propertyEnum:null,fieldEntityType:null,enumData:null,postCreate:function(){this.inherited(arguments);
this.propertyEnum=b;this._initComps();this._initEvent()},_initComps:function(){this.editBtn=new r({label:"\u7f16\u8f91"});this.saveBtn=new r({label:"\u4fdd\u5b58"});this.cancelBtn=new r({label:"\u53d6\u6d88"});this.addBtnGroup.appendChild(this.cancelBtn.domNode);this.addBtnGroup.appendChild(this.saveBtn.domNode);this.editBtnGroup.appendChild(this.editBtn.domNode);this._radioGroupNode=new t({item:this.item,propertyEnum:this.propertyEnum});this.fieldtypepanel.appendChild(this._radioGroupNode.domNode);
this.textRender=new x({item:this.item});this.filedName.appendChild(this.textRender.domNode)},_initEvent:function(){this.own(c(this._radioGroupNode,"onChange",e.hitch(this,this.onChangeRadio)),c(this.saveBtn,"click",e.hitch(this,this.onSave)),c(this.editBtn,"click",e.hitch(this,this.onEdit)),c(this.cancelBtn,"click",e.hitch(this,this.onCancel)),c(this.customerBtn,"click",e.hitch(this,this._onBack)))},_onBack:function(){$("#conditionpanel").removeClass("hide");$("#admin-header").removeClass("hide");
this.textRender.hideError();this.enumFieldWidget&&this.enumFieldWidget.hideError();this.emit("list",{panelWidgetId:this.panelWidgetId})},init:function(){this.showButton();this.item&&(-1!==f.indexOf("phone mobile position email qq coordinate".split(" "),this.item.name)?this.addClass(this.editBtnGroup,"hide"):this.removeClass(this.editBtnGroup,"hide"));e.mixin(this._radioGroupNode,{item:this.item,propertyEnum:this.propertyEnum});this._radioGroupNode.init();e.mixin(this.textRender,{item:this.item});
this.textRender.init();this.item?(this._radioGroupNode.triggleChange(this.item),this.titleNode.innerHTML="\u7f16\u8f91\u5b57\u6bb5"):this.titleNode.innerHTML="\u65b0\u589e\u5b57\u6bb5";this.onChangeRadio(this.item)},showButton:function(){this.item?(this.addClass(this.addBtnGroup,"hide"),this.removeClass(this.editBtnGroup,"hide")):(this.addClass(this.editBtnGroup,"hide"),this.removeClass(this.addBtnGroup,"hide"))},onChangeRadio:function(b){this.fieldremarkpanel.innerHTML=this._radioGroupNode.enumItem.remark;
var d;"Enum"==this._radioGroupNode.enumItem.type?(b&&(d=this.enumData[b.enumName].enumValues),this.renderEnum(d)):this.hideEnum()},renderEnum:function(b){this.enumFieldWidget&&this.enumFieldWidget.destroy();this.enumFieldWidget=new n({items:b,maxLength:this.item?"status"==this.item.name?6:10:10});this.enumFieldWidget.startup();this.enumWidgetContainerNode.appendChild(this.enumFieldWidget.domNode)},hideEnum:function(){this.enumFieldWidget&&(this.enumFieldWidget.destroyRecursive(),this.enumFieldWidget=
null)},getData:function(){var b=this.textRender.getData();e.mixin(b,{entityName:this.fieldEntityType,fieldType:this.item?this.item.type:this._radioGroupNode.enumItem.type});if(this.enumFieldWidget){var d=this.enumFieldWidget.getAll();e.mixin(b,{enumName:this.item?this.item.enumName:"",enumValues:d.items})}return b},onSave:function(){if(this.validate()){var b=this.getURI(),a=this.getData(),n=a.enumValues,c=!1;if(n)for(var f=0,t=n.length;f<t;f++)if(0==e.trim(n[f].enumLabel).length){c=!0;break}c?this.alert({content:"\u679a\u4e3e\u503c\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8bf7\u8f93\u5165\u540e\u518d\u4fdd\u5b58\u3002"}):
a&&b&&("status"==a.fieldName&&"WorkRecord"==a.entityName&&(a.entityName="Customer"),App.showLoading(),n=e.hitch(this,function(b){App.hideLoading();this.emit("list",{panelWidgetId:this.panelWidgetId});d.clearCacheData("LAYOUT");d.clearCacheData("FIELDMETADATAS");App.Storage.remove("metadata");$("#conditionpanel").removeClass("hide");$("#admin-header").removeClass("hide")}),c=e.hitch(this,function(b){App.hideLoading()}),this.item?xhr.put(b,a,n,c):(a.localId="-"+(new Date).getTime(),xhr.post(b,a,n,c)))}},
validate:function(){this.textRender.validate();return!this.textRender.isValid?(setTimeout(e.hitch(this,function(){this.textRender.showError()}),100),!1):this.enumFieldWidget&&(this.enumFieldWidget.validate(),!this.enumFieldWidget.isValid)?(this.enumFieldWidget.showError(),!1):!0},getURI:function(){return this.item?"business/"+App.apiVersion+"/dynattr/update":"business/"+App.apiVersion+"/dynattr/save"},onCancel:function(){this.item?this.toggleReadyOnly(!0):($("#conditionpanel").removeClass("hide"),
$("#admin-header").removeClass("hide"),this.enumFieldWidget&&this.enumFieldWidget.destroy(),this.textRender.hideError(),this.emit("list",{panelWidgetId:this.panelWidgetId}))},onEdit:function(b){this.toggleReadyOnly()},toggleReadyOnly:function(b){this.enumFieldWidget&&this.enumFieldWidget.toggleReadOnly(b);this.textRender.toggleReadOnly(b);p.toggle(this.addBtnGroup,"hide");p.toggle(this.editBtnGroup,"hide")},onDisable:function(){},onEnabled:function(){}});var t=g("RadioGroupNode",[h,q],{templateString:"\x3cdiv\x3e\x3c/div\x3e",
item:null,radios:null,enumItem:null,propertyEnum:null,postCreate:function(){this.inherited(arguments);this._initComps()},init:function(){this._initUI()},_initComps:function(){this.radios=[];for(var b=0;b<this.propertyEnum.length;b++){var d=new w({enumItem:this.propertyEnum[b]});this.own(c(d,"onChecked",e.hitch(this,this.onChange)));this.radios.push(d);this.domNode.appendChild(d.domNode)}this.radios[0].setChecked()},_initUI:function(){var b=!1;this.item&&(b=!0);var d=0;if(this.radios&&0<this.radios.length)for(var a=
0;a<this.radios.length;a++)if(this.radios[a].toggleDisabled(b),this.item&&this.item.type==this.radios[a].enumItem.type||!this.item&&0==a)d=a;this.radios[d].setChecked()},toggleReadOnly:function(b){for(var d=0,a=this.radios.length;d<a;d++)this.radios[d].toggleDisabled(b)},onChange:function(b){this.enumItem=b.enumItem;for(var d=0;d<this.radios.length;d++)b!=this.radios[d]&&this.radios[d].setUnchecked();this.emit("onChange",null)},triggleChange:function(b){for(var d=0,a=this.radios.length;d<a;d++)if(this.radios[d].enumItem.type==
b.type){this.radios[d].setChecked();break}}}),w=g("Radio",[h,k,q],{templateString:"\x3cspan class\x3d'radioSpan text' data-dojo-attach-event\x3d'onclick:onChecked'\x3e\x3cinput type\x3d'checkbox' name\x3d'ftradiogroup' data-dojo-attach-point\x3d'radio'\x3e\x3clabel data-dojo-attach-point\x3d'radiolabel'\x3e\x3c/label\x3e\x3c/span\x3e",enumItem:null,disabled:!1,toggleDisabled:function(b){this.disabled=b;this.radio.disabled=this.disabled;b?p.add(this.domNode,"radio-disabled"):p.remove(this.domNode,
"radio-disabled")},postCreate:function(){this.inherited(arguments);this.radiolabel.innerHTML=this.enumItem.label;this.disabled&&(this.radio.disabled=!0)},setChecked:function(){this.radio.checked=!0;this.emit("onChecked",this)},setUnchecked:function(){this.radio.checked=!1},onChecked:function(){this.disabled||(this.radio.checked=!0,this.emit("onChecked",this))}}),x=g("TextRender",[h,k],{templateString:"\x3cdiv class\x3d'textRender'\x3e\u5b57\u6bb5\u540d\u79f0\uff1a\x3cinput type\x3d'text' data-dojo-attach-point\x3d'fieldname' class\x3d'inputc hide'\x3e\x3cspan data-dojo-attach-point\x3d'fieldLabel' class\x3d'text hide pl10'\x3e\x3c/span\x3e\x3cspan data-dojo-attach-point\x3d'validMsg'\x3e\x3c/span\x3e\x3c/div\x3e",
item:null,isValid:!0,invalidMessage:"",tipComps:null,entityName:null,postCreate:function(){this.inherited(arguments);this.tipComps=new s({targetNode:this.fieldname,message:"",preventDefault:!0});this._initEvent()},init:function(){this.item?(this.fieldname.value=l.unescape(this.item.label),this.fieldLabel.innerHTML=this.item.label,this.removeClass(this.fieldLabel,"hide"),this.addClass(this.fieldname,"hide")):(this.fieldname.value="",this.fieldLabel.innerHTML="",this.addClass(this.fieldLabel,"hide"),
this.removeClass(this.fieldname,"hide"));this.isValid=!0;this.hideInValidStyle()},destroy:function(){this.tipComps&&this.tipComps.destroy();this.inherited(arguments)},_initEvent:function(){this.own(c(this.fieldname,"blur",e.hitch(this,this.blurHandler)),c(this.fieldname,"focus",e.hitch(this,this.focusHandler)),c(this.fieldname,"keyDown",e.hitch(this,this.keyDownHandler)))},keyDownHandler:function(){this.hideInValidStyle();this.tipComps.hideTip()},blurHandler:function(){this.tipComps.hideTip();this.validate()},
focusHandler:function(){this.isValid||this.tipComps.showTip(this.invalidMessage)},validate:function(){this.validator()?this.hideInValidStyle():this.showInValidStyle()},validator:function(){this.isValid=!0;64<this.fieldname.value.length&&(this.invalidMessage="\u540d\u79f0\u6700\u957f\u53ea\u53ef\u8f93\u516564\u4e2a\u5b57",this.isValid=!1);var b=this.fieldname.value.replace(/(^\s*)|(\s*$)/g,"");0==b.length?(this.invalidMessage="\u8bf7\u586b\u5199\u5b57\u6bb5\u540d\u79f0",this.isValid=!1):b.match(/^(?![0-9])[a-zA-Z0-9\u4e00-\u9fa5\s]+$/g)||
(this.invalidMessage="\u5b57\u6bb5\u540d\u79f0\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\u4e14\u4e0d\u80fd\u5305\u542b !@#$%^\x26*() \u7b49\u7279\u6b8a\u5b57\u7b26",this.isValid=!1);return this.isValid},toggleReadOnly:function(b){p.toggle(this.fieldLabel,"hide");p.toggle(this.fieldname,"hide");this.tipComps.hideTip();this.hideInValidStyle();b&&(this.fieldname.value=this.item.label)},showInValidStyle:function(){this.setStyle(this.fieldname,"border","1px solid #d46464")},hideInValidStyle:function(){this.setStyle(this.fieldname,
"border","1px solid #dcdcdc")},getData:function(){var b=this.fieldname.value.replace(/(^\s*)|(\s*$)/g,"");return{fieldName:this.item?this.item.name:null,fieldLabel:l.escape(b)}},showError:function(){this.tipComps.showTip(this.invalidMessage)},hideError:function(){this.tipComps.hideTip()}});return a})},"app/util/escape":function(){define(["dojo/_base/lang","dojo/_base/array"],function(g,k){return{ruleArray:'"$%\'"()-/\x3c\x3e?[\\]_{|} '.split(""),escape:function(a){g.isString(a)&&k.forEach(this.ruleArray,
function(h){switch(h){case "$":a=a.replace(/\$/gm,"\x26#36;");break;case "%":a=a.replace(/%/gm,"\x26#37;");break;case "(":a=a.replace(/\(/gm,"\x26#40;");break;case ")":a=a.replace(/\)/gm,"\x26#41;");break;case "-":a=a.replace(/-/gm,"\x26#45;");break;case "\x3c":a=a.replace(/</gm,"\x26#60;");break;case "\x3e":a=a.replace(/>/gm,"\x26#62;");break;case "\x26nbsp":a=a.replace(/\&nbsp/gm,"\x26#38;nbsp")}});return a},unescape:function(a){g.isString(a)&&k.forEach(this.ruleArray,function(h){switch(h){case "$":a=
a.replace(/\&\#36;/g,"$");break;case "%":a=a.replace(/&#37;/gm,"%");break;case "(":a=a.replace(/&#40;/gm,"(");break;case ")":a=a.replace(/&#41;/gm,")");break;case "-":a=a.replace(/&#45;/gm,"-");break;case "\x3c":a=a.replace(/&#60;/gm,"\x3c").replace(/&lt;/gm,"\x3c");break;case "\x3e":a=a.replace(/&#62;/gm,"\x3e").replace(/&gt;/gm,"\x3e");break;case "\x26":a=a.replace(/&#38;/gm,"\x26").replace(/&amp;/gm,"\x26")}});return a}}})},"chanjet/form/Tooltip":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/on","dijit/Tooltip","dijit/_Widget"],function(g,k,a,h,l){return g("chanjet.form.Tooltip",[l],{targetNode:null,message:"",preventDefault:!1,defaultPosition:"after-centered",containerNode:null,position:[],postCreate:function(){this.inherited(arguments);0==this.position.length&&this.position.push(this.defaultPosition);this.preventDefault||this._initDefaultEvent();this._masterTT=new h._MasterTooltip;this._domNodeHolder=document.createDocumentFragment()},destroy:function(){this.hideTip();this.inherited(arguments)},
_initDefaultEvent:function(){this.own()},_mouseenterHandler:function(){this.showTip()},_mouseleaveHandler:function(){this.hideTip()},show:function(a,e,f,c){c&&c.appendChild(this._masterTT.domNode);f&&(f=array.map(f,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));this._aroundNode=e;return this._masterTT.show(a,e,f)},hide:function(a){a||(a=this.aroundNode);this._domNodeHolder.appendChild(this._masterTT.domNode);return this._masterTT&&this._masterTT.hide(a)},showTip:function(a){this.containerNode&&
(h._masterTT||(dijit._masterTT=h._masterTT=new h._MasterTooltip),this.containerNode.appendChild(h._masterTT.domNode));this.message=a||this.message;h.show(this.message,this.targetNode,this.position)},hideTip:function(){h.hide(this.targetNode)}})})},"app/vm/field/FieldEnumWidget":function(){define("dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin dijit/_WidgetBase dijit/registry dojo/dom-attr dojo/_base/array dojo/on dojo/query dojo/dom-class app/vm/field/FieldEnumNodeWidget dijit/form/RadioButton dijit/form/Button dijit/_Container dijit/_Contained chanjet/form/Tooltip dojo/dnd/Source".split(" "),
function(g,k,a,h,l,m,e,f,c,p,q,r,s,n,d,b,t){return g("app.view.widget.enumFieldWidget",[h,a,n,d],{templateString:'\x3cdiv class\x3d"fieldWidget"\x3e\x3cdiv class\x3d"title"\x3e\x3cspan\x3e\u679a\u4e3e\u503c\u9879\x3cdiv class\x3d"newEnum" data-dojo-attach-point\x3d"newNode"\x3e\x3cspan class\x3d"addIcon"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"disabled mask" data-dojo-attach-point\x3d"mask"\x3e\x3c/div\x3e\x3c/div\x3e',
items:null,modifyItems:null,nodes:null,nodeValues:null,isValid:!0,radioButton:null,tipComps:null,dropComps:null,invalidMessage:null,maxLength:10,postCreate:function(){this.nodes=[];this.nodeValues=[];this.items?this.modifyItems=k.clone(this.items):(this.modifyItems=[],this.toggleReadOnly());this.isValid=!0;this._initComps();this._bindEvent()},destroy:function(){this.tipComps.destroy();for(var b=0;b<this.nodes.length;b++)this.nodes[b].destroy();this.inherited(arguments)},_initComps:function(){this.tipComps=
new b({targetNode:this.newNode,message:"",preventDefault:!0});this.dropComps=new t(this.containerNode,{withHandles:!0,selfCopy:!0});if(0<this.modifyItems.length)for(var d=0;d<this.modifyItems.length;d++){var a=this.initChild({item:this.modifyItems[d]});this.dropComps.insertNodes(!1,[a.domNode])}else for(d=0;4>d;d++)a=this.initChild(),this.dropComps.insertNodes(!1,[a.domNode]),this.nodes[this.nodes.length-1].setVal()},_bindEvent:function(){this.own(f(this.newNode,"click",k.hitch(this,this._addOption)))},
_addOption:function(){var b=this.initChild();b.toggleReadOnly();this.dropComps.insertNodes(!1,[b.domNode]);this.tipComps.hideTip()},toggleReadOnly:function(b){"none"!=this.mask.style.display?(this.mask.style.display="none",this.newNode.style.display="block"):(this.newNode.style.display="none",this.mask.style.display="block");for(var d=0,a=this.nodes.length;d<a;d++)this.nodes[d].toggleReadOnly(b);b&&this.reset()},reset:function(){for(var b=0;b<this.nodes.length;b++)this.nodes[b].destroy();this.nodes.length=
0;this.items&&(this.modifyItems=k.clone(this.items));this._initComps()},initChild:function(b){var d={onRemove:k.hitch(this,this.removeChild),checkUnique:k.hitch(this,this.checkUnique),maxLength:this.maxLength};b?k.mixin(d,b):"";b=new q(d);this.nodes.push(b);return b},removeChild:function(b,d){var a=this.getIndexOfChild(b);d||(this.modifyItems.splice(a,1),this.nodes.splice(a,1));b.destroy()},checkUnique:function(b){for(var d=!0,a=0;a<this.nodes.length;a++)if(b!=this.nodes[a]&&this.nodes[a].item&&this.nodes[a].item.enumLabel==
b.item.enumLabel){d=!1;break}return d},getAll:function(){for(var b=0,d=this.nodes.length;b<d;b++)for(var a=0,n=this.containerNode.children.length;a<n;a++)this.nodes[b].domNode==this.containerNode.children[a]&&(this.nodes[b].item.index=a);this.modifyItems=this.modifyItems.sort(function(b,d){return b.index-d.index});return{items:this.modifyItems}},validate:function(){this.isValid=!0;this.invalidMessage=null;if(0==this.nodes.length)this.isValid=!1,this.invalidMessage="\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u679a\u4e3e\u9879";
else for(var b=0;b<this.nodes.length;b++)this.nodes[b].validate(),this.isValid=this.isValid&&this.nodes[b].isValid},showError:function(){if(this.invalidMessage)this.tipComps.showTip(this.invalidMessage);else for(var b=0;b<this.nodes.length;b++)if(!this.nodes[b].isValid){this.nodes[b].showError();break}},hideError:function(){this.tipComps.hideTip();for(var b=0;b<this.nodes.length;b++)this.nodes[b].hideError()}})})},"app/vm/field/FieldEnumNodeWidget":function(){define("dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin app/util/_WidgetBase dojo/dom-style dojo/dom-class dojo/on dojo/keys dojo/string app/vm/field/_placeholder chanjet/form/Tooltip".split(" "),
function(g,k,a,h,l,m,e,f,c,p,q){return g("app.view.widget.enumFieldNodeWidget",[h,a],{templateString:'\x3cdiv class\x3d"fieldNode"\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"labelNode"\x3e\x3cdiv class\x3d"drag-i dojoDndHandle" data-dojo-attach-point\x3d"dragNode"  \x3e\x3c/div\x3e\x3cdiv class\x3d"check-i" data-dojo-attach-point\x3d"checkNodeWrapper" style\x3d"display:none;"\x3e\x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"checkNode" checked\x3d"checked" class\x3d"checkNode no-detect" /\x3e\x3cspan class\x3d"checkLabel" data-dojo-attach-point\x3d"checkLabel"\x3e\u542f\u7528\x3c/span\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"delNode" class\x3d"del-i no-detect"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"labelVal" class\x3d"label-i"\x3e\u8bf7\u8f93\u5165\u5b57\u6bb5\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"text hide" data-dojo-attach-point\x3d"textNode"\x3e\x3cinput type\x3d"text" data-dojo-attach-point\x3d"textVal"/\x3e\x3c/div\x3e\x3c/div\x3e',
item:null,isValid:!0,invalidMessage:"",maxLength:10,status:"read",constructor:function(a){k.mixin(this,a)},postCreate:function(){this.inherited(arguments);this.item?(this.labelVal.innerHTML=this.item.enumLabel,this.textVal.value=this.item.enumLabel,this.checkNode.checked=this.item.isActive,this.item.isActive||(this.item.delflag="y"),this.hideDom(this.delNode),this.hideDom(this.dragNode)):(this.showDom(this.checkNodeWrapper),this.checkNode.disabled=!0);this.tipComps=new q({targetNode:this.domNode,
message:"",preventDefault:!0});this._bindEvent()},destroy:function(){this.tipComps.destroy();this.inherited(arguments)},_bindEvent:function(){this.own(e(this.delNode,"click",k.hitch(this,this._removeHandler)),e(this.checkNode,"click",k.hitch(this,this._disableHandler)),e(this.checkNodeWrapper,"click",k.hitch(this,function(){this.checkNode.click()})),e(this.domNode,e.selector(".label-i","click"),k.hitch(this,this._enterEdit)),e(this.textVal,"focus",k.hitch(this,this._focusHandler)),e(this.textVal,
"keyPress",k.hitch(this,this._keyPressHandler)),e(this.textVal,"blur",k.hitch(this,this._blurHandler)))},_removeHandler:function(){this.onRemove(this,!1)},_disableHandler:function(a){this.checkNode.checked?delete this.item.delflag:this.item.delflag="y";a.stopPropagation()},_enterEdit:function(){this.addClass(this.labelNode,"hide");this.removeClass(this.textNode,"hide");this.textVal.focus()},_focusHandler:function(){this.isValid||this.tipComps.showTip(this.invalidMessage)},_keyPressHandler:function(a){switch(a.keyCode){case f.ENTER:this.setVal()}},
_blurHandler:function(){this.removeClass(this.labelNode,"hide");this.addClass(this.textNode,"hide");this.tipComps.hideTip();this.setVal();this.validate()},setVal:function(){var a=c.trim(this.textVal.value);this.labelVal.innerHTML=a||"\u8bf7\u8f93\u5165\u5b57\u6bb5";this.item?this.item.enumLabel=a:(this.item={enumValue:"",enumLabel:a},a=this.getParent(),a.modifyItems?a.modifyItems.push(this.item):a.modifyItems=[this.item])},validate:function(){this.validator()?this.hideInValidStyle():this.showInValidStyle()},
validator:function(){this.isValid=!0;this.item?this.item.enumLabel.length>this.maxLength?(this.isValid=!1,this.invalidMessage="\u679a\u4e3e\u957f\u5ea6\u6700\u5927\u4e3a"+this.maxLength):0==this.item.enumLabel.length?(this.isValid=!1,this.invalidMessage="\u679a\u4e3e\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"):this.checkUnique(this)?this.isValid=!0:(this.isValid=!1,this.invalidMessage="\u679a\u4e3e\u503c\u91cd\u590d"):(this.isValid=!1,this.invalidMessage="\u679a\u4e3e\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");
return this.isValid},showInValidStyle:function(){l.set(this.textVal,"background","#ffd6d5");l.set(this.labelNode,"background","#ffd6d5")},hideInValidStyle:function(){l.set(this.textVal,"background","");l.set(this.labelNode,"background","")},onRemove:function(a,e){},showError:function(){this.tipComps.showTip(this.invalidMessage)},hideError:function(){this.tipComps.hideTip()},toggleReadOnly:function(){"edit"==this.status?(this.checkNodeWrapper.style.display="none",this.dragNode.style.display="none",
this.status="read"):(this.checkNodeWrapper.style.display="block",this.dragNode.style.display="block",this.status="edit")}})})},"app/vm/field/_placeholder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Evented","dojo/query","dojo/on"],function(g,k,a,h,l){var m=function(a,f){if(a&&a.parentNode)return-1<a.parentNode.className.indexOf(f)?a.parentNode:m(a.parentNode,f)};return g([a],{postCreate:function(){this.item&&(this.defaultLabelNode.style.display="none",this.textNode.style.display=
"none",this.labelNode.style.display="block",h("i",this.labelNode)[0].style.display="none");if(this.labelNode&&this.textNode){var a=this;this.own(l(this.domNode,l.selector(".label","click"),k.hitch(this,function(f){var c=f.target;"i"==c.tagName.toLowerCase()?this.emit("onIconClick",a):(-1==c.className.indexOf("label")&&(c=m(f.target,"label")),c.style.display="none",this.textNode.style.display="block",this.textVal.focus())})))}},_attachsKeydown:function(){this.textVal.value?this.labelNode.style.display=
"block":this.defaultLabelNode.style.display="block";this.textNode.style.display="none"}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(g,k,a){return g("dijit.form.RadioButton",[k,a],{baseClass:"dijitRadio"})})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),
function(g,k,a,h,l,m,e,f,c){h("dijit-legacy-requires")&&m(0,function(){g(["dijit/form/RadioButton"])});return k("dijit.form.CheckBox",[e,f],{templateString:c,baseClass:"dijitCheckBox",_setValueAttr:function(a,c){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,c)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},
_fillContent:function(){},_onFocus:function(){this.id&&l("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&l("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(g,k,a,h){return g("dijit.form.ToggleButton",[a,h],{baseClass:"dijitToggleButton",setChecked:function(a){k.deprecated("setChecked("+
a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(g,k){return g("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(a){var h=this.checked;this._set("checked",!h);var g=this.inherited(arguments);this.set("checked",g?this.checked:h);return g},_setCheckedAttr:function(a,g){this._set("checked",a);var l=this.focusNode||this.domNode;
this._created&&k.get(l,"checked")!=!!a&&k.set(l,"checked",!!a);l.setAttribute(this._aria_attr,String(a));this._handleOnChange(a,g)},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.checked&&a.setAttribute("checked","checked")},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(g,k){return g("dijit.form._CheckBoxMixin",null,{type:"checkbox",
value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(a){this._set("readOnly",a);k.set(this.focusNode,"readOnly",a)},_setLabelAttr:void 0,_getSubmitValue:function(a){return null==a||""===a?"on":a},_setValueAttr:function(a){a=this._getSubmitValue(a);this._set("value",a);k.set(this.focusNode,"value",a)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));k.set(this.focusNode,"value",this.value)},_onClick:function(a){return this.readOnly?
(a.stopPropagation(),a.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query ../registry".split(" "),function(g,k,a,h,l,m){return k("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var a=[];l("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(h.hitch(this,function(f){f.name==this.name&&f.form==this.focusNode.form&&(f=m.getEnclosingWidget(f))&&
a.push(f)}));return a},_setCheckedAttr:function(a){this.inherited(arguments);this._created&&a&&g.forEach(this._getRelatedWidgets(),h.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==a?"on":a},_onClick:function(e){return this.checked||this.disabled?(e.stopPropagation(),e.preventDefault(),!1):this.readOnly?(e.stopPropagation(),e.preventDefault(),g.forEach(this._getRelatedWidgets(),h.hitch(this,function(e){a.set(this.focusNode||this.domNode,
"checked",e.checked)})),!1):this.inherited(arguments)}})})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(g,k,a,h,l,m,e,f,c,p,q,r){a.isAsync||f(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var s=k("dojo.dnd.Source",q,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,
delay:0,accept:["text"],generateText:!0,constructor:function(a,d){h.mixin(this,h.mixin({},d));var b=this.accept;if(b.length){this.accept={};for(var e=0;e<b.length;++e)this.accept[b[e]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&l.add(this.node,"dojoDndSource");this.targetState="";this.accept&&l.add(this.node,"dojoDndTarget");this.horizontal&&l.add(this.node,"dojoDndHorizontal");this.topics=[c.subscribe("/dnd/source/over",
h.hitch(this,"onDndSourceOver")),c.subscribe("/dnd/start",h.hitch(this,"onDndStart")),c.subscribe("/dnd/drop",h.hitch(this,"onDndDrop")),c.subscribe("/dnd/cancel",h.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,d){if(this==a)return!this.copyOnly||this.selfAccept;for(var b=0;b<d.length;++b){for(var c=a.getItem(d[b].id).type,e=!1,f=0;f<c.length;++f)if(c[f]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,d){if(a)return!0;2>arguments.length&&(d=this==r.manager().target);
if(d){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){s.superclass.destroy.call(this);g.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){s.superclass.onMouseMove.call(this,a);var d=r.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var b=this.getSelectedNodes();
b.length&&d.startDrag(this,b,this.copyState(p.getCopyKeyState(a),!0))}if(this.isDragging){b=!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=m.position(this.current,!0);b=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==m.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||b!=this.before)this._markTargetAnchor(b),d.canDrop(!this.current||d.source!=this||!(this.current.id in this.selection))}}},
onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||!p.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,s.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,s.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=r.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||
!(this.current.id in this.selection))))},onDndStart:function(a,d,b){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?b?"Copied":"Moved":"");d=this.accept&&this.checkAcceptance(a,d);this._changeState("Target",d?"":"Disabled");this==a&&r.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,d,b,c){if(this==c)this.onDrop(a,d,b);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=
this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,d,b){if(this!=a)this.onDropExternal(a,d,b);else this.onDropInternal(d,b)},onDropExternal:function(a,d,b){var c=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,d){return c.call(this,a.getItem(b.id).data,d)}:b?function(b){var d=a.getItem(b.id);b=b.cloneNode(!0);b.id=p.getUniqueId();return{node:b,data:d.data,type:d.type}}:function(b){var d=a.getItem(b.id);a.delItem(b.id);return{node:b,
data:d.data,type:d.type}};this.selectNone();!b&&!this.creator&&a.selectNone();this.insertNodes(!0,d,this.before,this.current);!b&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=c},onDropInternal:function(a,d){var b=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(d)this._normalizedCreator=this.creator?function(a,d){return b.call(this,this.getItem(a.id).data,d)}:function(b){var a=this.getItem(b.id);b=b.cloneNode(!0);b.id=p.getUniqueId();return{node:b,
data:a.data,type:a.type}};else{if(!this.current)return;this._normalizedCreator=function(b){var a=this.getItem(b.id);return{node:b,data:a.data,type:a.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=b}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){s.superclass.onOverEvent.call(this);r.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){s.superclass.onOutEvent.call(this);
r.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){this.current==this.targetAnchor&&this.before==a||(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!e.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(l.contains(a,"dojoDndHandle"))return!0;if(l.contains(a,"dojoDndItem")||l.contains(a,"dojoDndIgnore"))break}return!1}});return s})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),
function(g,k,a,h,l,m,e,f,c,p,q,r){var s=k("dojo.dnd.Selector",r,{constructor:function(a,d){d||(d={});this.singular=d.singular;this.autoSync=d.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(c(this.node,p.press,h.hitch(this,"onMouseDown")),c(this.node,p.release,h.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new f,d=q._empty,b;for(b in this.selection)b in d||a.push(l.byId(b));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},
selectAll:function(){this.forInItems(function(a,d){this._addItemClass(l.byId(d),"Selected");this.selection[d]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=q._empty,d;for(d in this.selection)if(!(d in a)){var b=l.byId(d);this.delItem(d);m.destroy(b)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(c,d){d=d||a.global;var b=this.selection,e=q._empty,f;for(f in b)f in e||c.call(d,this.getItem(f),f,this)},sync:function(){s.superclass.sync.call(this);
this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],d=q._empty,b;for(b in this.selection)b in d||this.getItem(b)||a.push(b);g.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,d,b,c){var e=this._normalizedCreator;this._normalizedCreator=function(b,d){var c=e.call(this,b,d);a?(this.anchor?this.anchor!=c.node&&(this._removeItemClass(c.node,"Anchor"),this._addItemClass(c.node,"Selected")):(this.anchor=c.node,this._removeItemClass(c.node,"Selected"),
this._addItemClass(this.anchor,"Anchor")),this.selection[c.node.id]=1):(this._removeItemClass(c.node,"Selected"),this._removeItemClass(c.node,"Anchor"));return c};s.superclass.insertNodes.call(this,d,b,c);this._normalizedCreator=e;return this},destroy:function(){s.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!q.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=
!0,e.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){q.getCopyKeyState(a)||this._removeSelection();var d=this.getAllNodes();if(d.length&&(this.anchor||(this.anchor=d[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var b=0,c;b<d.length&&!(c=d[b],c==this.anchor||c==this.current);++b);for(++b;b<d.length;++b){c=d[b];if(c==this.anchor||c==this.current)break;this._addItemClass(c,"Selected");this.selection[c.id]=
1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?q.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):q.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):
(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&
(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=c(this.node,p.move,h.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=q._empty,d;for(d in this.selection)if(!(d in a)){var b=l.byId(d);b&&this._removeItemClass(b,"Selected")}this.selection=
{};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return s})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(g,k,a,h,l,m,e,f,c,p,q,r,s,n){k=k("dojo.dnd.Container",c,{skipForm:!1,allowNested:!1,constructor:function(a,b){this.node=m.byId(a);
b||(b={});this.creator=b.creator||null;this.skipForm=b.skipForm;this.parent=b.dropParent&&m.byId(b.dropParent);this.map={};this.current=null;this.containerState="";e.add(this.node,"dojoDndContainer");(!b||!b._skipStartup)&&this.startup();this.events=[q(this.node,s.over,h.hitch(this,"onMouseOver")),q(this.node,s.out,h.hitch(this,"onMouseOut")),q(this.node,"dragstart",h.hitch(this,"onSelectStart")),q(this.node,"selectstart",h.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},
setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(d,b){b=b||a.global;var c=this.map,e=n._empty,f;for(f in c)f in e||d.call(b,c[f],f,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return r((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=n.getUniqueId();var c=b.getAttribute("dndType"),
e=b.getAttribute("dndData");a[b.id]={data:e||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var e;if(c)for(b=0;b<a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),c.parentNode.insertBefore(e.node,c);else for(b=0;b<a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),this.parent.appendChild(e.node);
return this},destroy:function(){g.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=n._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&
b!=this.node;)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){if(!this.skipForm||
!n.isFormElement(a))a.stopPropagation(),a.preventDefault()},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a,f=a.toLowerCase()+"State";e.replace(this.node,c+b,c+this[f]);this[f]=b},_addItemClass:function(a,b){e.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){e.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&e.contains(a,"dojoDndItem"))return a;
return null},_normalizedCreator:function(a,b){var c=(this.creator||this.defaultCreator).call(this,a,b);h.isArray(c.type)||(c.type=["text"]);c.node.id||(c.node.id=n.getUniqueId());e.add(c.node,"dojoDndItem");return c}});n._createNode=function(a){return!a?n._createSpan:function(b){return f.create(a,{innerHTML:b})}};n._createTrTd=function(a){var b=f.create("tr");f.create("td",{innerHTML:a},b);return b};n._createSpan=function(a){return f.create("span",{innerHTML:a})};n._defaultCreatorNodes={ul:"li",ol:"li",
div:"div",p:"div"};n._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?n._createTrTd:n._createNode(n._defaultCreatorNodes[a]);return function(a,c){var e=a&&h.isObject(a),d,f;e&&a.tagName&&a.nodeType&&a.getAttribute?(d=a.getAttribute("dndData")||a.innerHTML,e=(e=a.getAttribute("dndType"))?e.split(/\s*,\s*/):["text"],f=a):(d=e&&a.data?a.data:a,e=e&&a.type?a.type:["text"],f=("avatar"==c?n._createSpan:b)(String(d)));f.id||(f.id=n.getUniqueId());return{node:f,data:d,type:e}}};
return k})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(g,k,a,h,l,m,e,f,c,p,q,r,s,n){var d=k("dojo.dnd.Manager",[m],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:e("touch")?0:16,OFFSET_Y:e("touch")?-64:16,overSource:function(a){this.avatar&&
(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());p.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),p.publish("/dnd/source/over",null)):p.publish("/dnd/source/over",null)},startDrag:function(b,e,d){function f(a){a.preventDefault();a.stopPropagation()}s.autoScrollStart(h.doc);this.source=b;this.nodes=e;this.copy=Boolean(d);this.avatar=this.makeAvatar();
h.body().appendChild(this.avatar.node);p.publish("/dnd/start",b,e,this.copy);this.events=[c(h.doc,q.move,a.hitch(this,"onMouseMove")),c(h.doc,q.release,a.hitch(this,"onMouseUp")),c(h.doc,"keydown",a.hitch(this,"onKeyDown")),c(h.doc,"keyup",a.hitch(this,"onKeyUp")),c(h.doc,"dragstart",f),c(h.body(),"selectstart",f)];l.add(h.body(),"dojoDnd"+(d?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){l.remove(h.body(),
["dojoDndCopy","dojoDndMove"]);g.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new n(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var c=this.avatar;c&&(s.autoScrollNodes(a),c=c.node.style,c.left=a.pageX+this.OFFSET_X+"px",c.top=a.pageY+this.OFFSET_Y+"px",c=Boolean(this.source.copyState(r.getCopyKeyState(a))),this.copy!=c&&this._setCopyStatus(c));
e("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var c=Boolean(this.source.copyState(r.getCopyKeyState(a)));p.publish("/dnd/drop/before",this.source,this.nodes,c,this.target,a);p.publish("/dnd/drop",this.source,this.nodes,c,this.target,a)}else p.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case f.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case f.ESCAPE:p.publish("/dnd/cancel"),
this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==f.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();l.replace(h.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});r._manager=null;d.manager=r.manager=function(){r._manager||(r._manager=new d);return r._manager};return d})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),
function(g,k,a,h,l,m,e,f){return g("dojo.dnd.Avatar",null,{constructor:function(a){this.manager=a;this.construct()},construct:function(){var a=m.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),f=this.manager.source,g,k=m.create("tbody",null,a),l=m.create("tr",null,k),n=m.create("td",null,l),d=Math.min(5,this.manager.nodes.length),b=0;e("highcontrast")&&m.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},n);m.create("span",{innerHTML:f.generateText?
this._generateText():""},n);for(h.set(l,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});b<d;++b)f.creator?g=f._normalizedCreator(f.getItem(this.manager.nodes[b].id).data,"avatar").node:(g=this.manager.nodes[b].cloneNode(!0),"tr"==g.tagName.toLowerCase()&&(l=m.create("table"),m.create("tbody",null,l).appendChild(g),g=l)),g.id="",l=m.create("tr",null,k),n=m.create("td",null,l),n.appendChild(g),h.set(l,{"class":"dojoDndAvatarItem",style:{opacity:(9-b)/10}});this.node=a},destroy:function(){m.destroy(this.node);
this.node=!1},update:function(){l.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(e("highcontrast")){var c=a.byId("a11yIcon"),g="+";this.manager.canDropFlag&&!this.manager.copy?g="\x3c ":!this.manager.canDropFlag&&!this.manager.copy?g="o":this.manager.canDropFlag||(g="x");c.innerHTML=g}f("tr.dojoDndAvatarHeader td span"+(e("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},
"csp/Page":function(){define("csp/Page","dojo/_base/declare dojo/request/xhr dojo/_base/lang csp/Constants csp/AppConfig csp/util/Common".split(" "),function(g,k,a,h,l,m){return{_dataCache:{},getFieldMetadatas:function(a,f){this.getLayout(a,f);var c=this.getCacheData("FIELDMETADATAS",a+"-"+f);c||(c={});return c},getLayout:function(e,f){var c=this.getCacheData("LAYOUT",e+"-"+f);null==c&&(c={},m.getJson(m.formatUrl(l.CspUrl.App.layout,{name:e,type:f}),null,a.hitch(this,function(a){a.metadata&&this.setCacheData("FIELDMETADATAS",
e+"-"+f,a.metadata);a.layout&&(c=a.layout,this.setCacheData("LAYOUT",e+"-"+f,c))}),null,!0));return c},getEnumValues:function(e){var f=[];m.getJson(m.formatUrl(l.CspUrl.Metadata.enums,{enumName:e}),null,a.hitch(this,function(a){a&&(f=a,this.setCacheData("ENUMVALUES",e,a))}),null,!0);return f},getCacheData:function(a,f){return this._dataCache[a]&&this._dataCache[a][f]?this._dataCache[a][f]:null},setCacheData:function(a,f,c){this._dataCache[a]||(this._dataCache[a]={});this._dataCache[a][f]=c},clearCacheData:function(a,
f,c){a?f?c?this._dataCache[a][f][c]=null:this._dataCache[a][f]=null:this._dataCache[a]=null:this._dataCache={}}}})},"csp/Constants":function(){define("csp/Constants",[],function(g,k,a){return{DataTypes:{TEXT:"Text",REFER:"ForeignKey",DECIMAL:"Decimal",INTEGER:"Integer",BOOLEAN:"Boolean",PERCENTAGE:"Percentage",ANNIVERSARY:"Anniversary",DATE:"Date",DATETIME:"Timestamp",GEOPOINT:"GeoPoint",PHONE:"Phone",MOBILEPHONE:"MobilePhone",EMAIL:"Email",URI:"URI",IMAGE:"Image",ENUM:"Enum"},WidgetTypes:{VIEW_TEXT:"ViewText",
LINK_TEXT:"LinkText",CHECK_BOX:"CheckBox",RADIO_BOX:"RadioBox",TOGGLE:"Toggle",MAP:"Map",IMAGE:"Image",EDIT_TEXT:"EditText",LOOKUP:"Lookup",COMBO_BOX:"ComboBox",DATE_PICKER:"DatePicker",DATETIME_PICKER:"DatetimePicker",IMAGE_PICKER:"ImagePicker"}}})},"csp/AppConfig":function(){define("csp/AppConfig",["dojo/_base/declare","dojo/request/xhr","dojo/_base/lang","csp/ApiConfig","csp/util/Common"],function(g,k,a,h,l){return a.mixin({dataTypeUI:null,entityUI:null,entityPickers:null,getDataTypeUI:function(){this.dataTypeUI||
l.getJson(this.CspUrl.App.datatypeui,null,a.hitch(this,function(a){a&&(this.dataTypeUI=a)}),null,!0);return this.dataTypeUI},getEntityUI:function(){this.entityUI||l.getJson(this.CspUrl.App.objectui,null,a.hitch(this,function(a){a&&(this.entityUI=a)}),null,!0);return this.entityUI},getEntityPicker:function(g){this.entityPickers||l.getJson(this.CspUrl.App.pickers,null,a.hitch(this,function(a){a&&(this.entityPickers=a)}),null,!0);return this.entityPickers[g]}},h)})},"csp/ApiConfig":function(){define("csp/ApiConfig",
[],function(){var g={CspApi:{domain:"",app:"/chanjet/customer",prefix:"/services"}};window.dev&&window.HOST&&(g.CspApi.domain=HOST);g._CspUrl=g.CspApi.domain+g.CspApi.app+g.CspApi.prefix;g.CspUrl={logout:"/logout"};g.CspUrl.Auth={session:"/auth/session"};g.CspUrl.App={locale:"/app/locale",layout:"/app/layout/{name}/{type}",datatypeui:"/app/datatypeui",pickers:"/app/pickers"};g.CspUrl.Metadata={enums:"/metadata/enum/{enumName}"};g.CspUrl.Data={picker:"/data/picker/{pickerName}",queryById:"/data/query/{name}/{id}",
query:"/data/query/{name}"};g.CspUrl.Business={upsert:"/business/upsert/{name}","delete":"/business/delete/{name}/{id}"};g.CspUrl.Upload={uploadImage:"/business/v2/web/upload/uploadImage",cropImage:"/business/v2/web/contact/cropImage"};for(var k in g.CspUrl)if("string"==typeof g.CspUrl[k])g.CspUrl[k]=g._CspUrl+g.CspUrl[k];else if("object"==typeof g.CspUrl[k])for(var a in g.CspUrl[k])"string"==typeof g.CspUrl[k][a]&&(g.CspUrl[k][a]=g._CspUrl+g.CspUrl[k][a]);g.CspUrl.CIA={authorizeByJsonp:"http://cia.chanapp.chanjet.com/internal_api/authorizeByJsonp"};
g.CspUrl.Upload.uploadImage="/chanjet/customer/services/upload/uploadImage";g.CspUrl.Upload.cropImage="/chanjet/customer/business/v2/web/contact/cropImage";return g})},"csp/util/Common":function(){define("csp/AppConfig dojo/dom-construct dojo/dom-style dojo/cookie dojo/string csp/util/Request".split(" "),function(g,k,a,h,l,m){return{tips:function(e,f){this.tipsObj||(this.tipsObj=k.create("div",{style:"min-width: 150px;height: 45px;text-align: center;color: #f89b9b;background: rgba(255,253,244,0.95);border: solid 1px #e9e9e9;border-top: none;position: fixed;top: 46px;left: 36%;padding: 12px 20px;z-index:10002"}),
k.place(this.tipsObj,document.body,"last"));null!=this.tipsHandle&&clearTimeout(this.tipsHandle);this.isEmpty(e)?(a.set(this.tipsObj,"display","none"),this.tipsObj.innerHTML=""):(this.tipsObj.innerHTML=e,a.set(this.tipsObj,"display","block"),0!=f&&(f||(f=3E3),a.set(this.tipsObj,"left",(document.body.offsetWidth-this.tipsObj.offsetWidth)/2+"px"),that=this,this.tipsHandle=setTimeout(function(){a.set(that.tipsObj,"display","none");that.tipsObj.innerHTML=""},f)))},isEmpty:function(a){if(!a)return!0;a=
(""+a).replace(/(^\s*)|(\s*$)/g,"");return""==a||"null"==a||'""'==a?!0:!1},formatUrl:function(a,f){a=a.replace(/\{/g,"${");return l.substitute(a,f)},_getHeaders:function(){return{"content-type":"application/json"}},getCode:function(){return CSP_AUTH_CODE},getJson:function(a,f,c,g,h){var k=[];f=f||{};for(var l in f)k.push(l+"\x3d"+f[l]);k="?"+k.join("\x26");m(a+k,{data:f,method:"get",handleAs:"json",preventCache:!0,withCredentials:!0,sync:!!h,headers:this._getHeaders()}).then(c,g)},postJson:function(a,
f,c,g,h){m(a,{data:f||{},method:"post",handleAs:"json",withCredentials:!0,sync:!!h,headers:this._getHeaders()}).then(c,g)},getCookie:function(a){return h(a)},setCookie:function(a,f,c){h(a,f,{expires:"undefined"==typeof c?1209600:c,path:"/"})},logout:function(){this.getJson(g.CspUrl.logout,null,function(){window.location.reload()})},login:function(){this.setCookie("logined",null,-3600);this.setCookie("avatar",null,-3600);this.setCookie("isM",null,-3600);this.setCookie("token",null,-3600);this.setCookie("username",
null,-3600);this.setCookie("userid",null,-3600);this.setCookie("email",null,-3600)}}})},"csp/util/Request":function(){define("dojo/_base/declare dojo/_base/lang dojo/request dojo/request/notify dojo/request/script dojo/on dojo/cookie csp/AppConfig".split(" "),function(g,k,a,h,l,m,e,f){var c=!1,p={};return function(f,e){return{url:f,args:e,then:function(a,c){var d=this;require(["csp/util/Common"],function(b){p=b;d._then(a,c)})},_then:function(a,f){c?this.defer(this.then(a,f),200):(c=!0,this.request(this.url,
this.args,a,f),c=!1)},_sleep:function(a){var c=new Date;for(a=c.getTime()+a;!(c=new Date,c.getTime()>a););},request:function(c,f,d,b){var e=f.data,g=3E4;e&&e.timeout&&(g=e.timeout);f.timeout=g;f.withCredentials&&f.sync&&(f.withCredentials=!1);h("done",function(a){});e=p.getCode();c=0<=c.indexOf("?")?c+"\x26":c+"?";a(c+("code\x3d"+e),f).then(function(a){d&&d(a)},function(a){switch(a.response.status){case 0:errorText="\u60a8\u7684\u7f51\u7edc\u65e0\u6cd5\u8fde\u63a5\uff0c\u8bf7\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u662f\u5426\u7545\u901a";
break;case 401:errorText="\u5c1a\u672a\u767b\u9646";break;case 403:errorText="\u5e94\u7528\u672a\u6388\u6743"}b&&b(a.response)})}}}})},"dojo/request/notify":function(){define(["../Evented","../_base/lang","./util"],function(g,k,a){function h(a,c){return e.on(a,c)}var l=0,m=[].slice,e=k.mixin(new g,{onsend:function(a){l||this.emit("start");l++},_onload:function(a){this.emit("done",a)},_onerror:function(a){this.emit("done",a)},_ondone:function(a){0>=--l&&(l=0,this.emit("stop"))},emit:function(a,c){var e=
g.prototype.emit.apply(this,arguments);this["_on"+a]&&this["_on"+a].apply(this,m.call(arguments,1));return e}});h.emit=function(a,c,g){return e.emit(a,c,g)};return a.notify=h})},"dojo/request/script":function(){define("module ./watch ./util ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(g,k,a,h,l,m,e,f,c,p){function q(a,c){a.canDelete&&b._remove(a.id,c.options.frameDoc,!0)}function r(a){u&&u.length&&(h.forEach(u,function(a){b._remove(a.id,a.frameDoc);
a.frameDoc=null}),u=[]);return a.options.jsonp?!a.data:!0}function s(a){return!!this.scriptLoaded}function n(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function d(a,b){if(this.canDelete){var c=this.response.options;u.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function b(c,e,f){var g=a.parseArgs(c,a.deepCopy({},e));c=g.url;e=g.options;var h=a.deferred(g,q,
r,e.jsonp?null:e.checkString?n:s,d);l.mixin(h,{id:t+w++,canDelete:!1});e.jsonp&&(RegExp("[?\x26]"+e.jsonp+"\x3d").test(c)||(c+=(~c.indexOf("?")?"\x26":"?")+e.jsonp+"\x3d"+(e.frameDoc?"parent.":"")+t+"_callbacks."+h.id),h.canDelete=!0,v[h.id]=function(a){g.data=a;h.handleResponse(g)});a.notify&&a.notify.emit("send",g,h.promise.cancel);if(!e.canAttach||e.canAttach(h)){var p=b._attach(h.id,c,e.frameDoc);if(!e.jsonp&&!e.checkString)var u=m(p,x,function(a){if("load"===a.type||y.test(p.readyState))u.remove(),
h.scriptLoaded=a})}k(h);return f?h:h.promise}c.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===typeof a.opera||"[object Opera]"!==a.opera.toString())});var t=g.id.replace(/[\/\.\-]/g,"_"),w=0,x=c("script-readystatechange")?"readystatechange":"load",y=/complete|loaded/,v=this[t+"_callbacks"]={},u=[];b.get=b;b._attach=function(a,b,c){c=c||p.doc;var d=c.createElement("script");d.type="text/javascript";d.src=b;d.id=a;
d.async=!0;d.charset="utf-8";return c.getElementsByTagName("head")[0].appendChild(d)};b._remove=function(a,b,c){f.destroy(e.byId(a,b));v[a]&&(c?v[a]=function(){delete v[a]}:delete v[a])};b._callbacksProperty=t+"_callbacks";return b})},"url:app/vm/field/tpl/field_list.html":'\x3cdiv style\x3d"min-height:650px" class\x3d"field-list w1000"\x3e\n    \x3c!--\x3cdiv class\x3d"kh-field-title"\x3e\n         \x3cspan data-dojo-attach-point\x3d"customerbuttun"\x3e\u5b57\u6bb5\u7ba1\u7406\x3c/span\x3e\n    \x3c/div\x3e--\x3e\n    \x3cdiv style\x3d"display: none;" class\x3d"tabContainer"\x3e\n        \x3cspan class\x3d"fieldTab" rel\x3d"defaultView"  data-dojo-attach-point\x3d"defaultNode"\x3e\u9ed8\u8ba4\u5b57\u6bb5\x3c/span\x3e\n        \x3cspan class\x3d"fieldTab" rel\x3d"customView" data-dojo-attach-point\x3d"customNode"\x3e\u81ea\u5b9a\u4e49\u5b57\u6bb5\x3c/span\x3e\n         \x3cspan class\x3d"fieldTab" rel\x3d"disableView" data-dojo-attach-point\x3d"disableNode"\x3e\u505c\u7528\u5b57\u6bb5\x3c/span\x3e\n    \x3c/div\x3e\n\t\x3cdiv class\x3d"viewIntro" data-dojo-attach-point\x3d"viewIntroNode"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"content customerpanel" data-dojo-attach-point\x3d"containerNode"  style\x3d"min-height:570px;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:app/vm/field/tpl/field_detail.html":'\x3cdiv id\x3d"card_view" class\x3d\'field-detail  w1000\' style\x3d"min-height:600px"\x3e\n    \x3cdiv class\x3d"kh-field-title"\x3e\n        \x3ca class\x3d"back2list" href\x3d"javascript:void(0);" data-dojo-attach-point\x3d"customerBtn"\x3e\x3c \u8fd4\u56de\x3c/a\x3e\n        \x3cspan \x3e\u5b57\u6bb5\u5e93\x3c/span\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"customerpanel fieldPanel fieldDetail" style\x3d"min-height:570px;"\x3e\n\t\t \x3cdiv class\x3d"field"\x3e\n\t\t    \x3cdiv class\x3d"top"\x3e\n\t\t        \x3cspan class\x3d"label" data-dojo-attach-point\x3d"titleNode"\x3e${title}\x3c/span\x3e\n\t\t        \x3cdiv class\x3d"addBtnGroup fr hide" data-dojo-attach-point\x3d"addBtnGroup"\x3e\n\t\t        \x3c/div\x3e\n\t\t        \x3cdiv class\x3d"editBtnGroup fr hide" data-dojo-attach-point\x3d"editBtnGroup"\x3e\n\x3c!-- \t\t            \x3cspan class\x3d"button" data-dojo-attach-event\x3d"onclick:onDisable"\x3e\u505c\u7528\x3c/span\x3e --\x3e\n\t\t        \x3c/div\x3e\n\t\t        \x3cdiv class\x3d"enableBtnGroup fr hide" data-dojo-attach-point\x3d"enableBtnGroup"\x3e\n\t\t            \x26nbsp;\n\t\t            \x3cspan class\x3d"button" data-dojo-attach-event\x3d"onclick:onEnabled"\x3e\u542f\u7528\x3c/span\x3e\n\t\t        \x3c/div\x3e\n\t\t    \x3c/div\x3e\n\t\t    \x3cdiv class\x3d"line"\x3e\x3ci\x3e\x3c/i\x3e\x3c/div\x3e\n\t\t    \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"containerNode"\x3e\n\t\t        \x3cdiv class\x3d"tr" data-dojo-attach-point\x3d"filedName"\x3e\x3c/div\x3e\n\t\t        \x3cdiv class\x3d"tr"\x3e\n\t\t            \x3cdiv class\x3d"fieldClue"\x3e\u5b57\u6bb5\u7c7b\u578b\uff1a\x3c/div\x3e\n\t\t            \x3cdiv data-dojo-attach-point\x3d"fieldtypepanel"\x3e\x3c/div\x3e\n\t\t        \x3c/div\x3e\n\t\t        \x3cdiv class\x3d"tr mt20"\x3e\n\t\t          \x3cspan class\x3d"fieldClue"\x3e\u5b57\u6bb5\u8bf4\u660e\uff1a \x3c/span\x3e\n\t\t          \x3cspan data-dojo-attach-point\x3d"fieldremarkpanel" class\x3d"text"\x3e\x3c/span\x3e\n\t\t        \x3c/div\x3e\n\t\t        \x3cdiv class\x3d"tr"\x3e\n\x3c!-- \t\t          \x3cspan\x3e\u679a\u4e3e\u503c\uff08\u6211\u4eec\u5c06\u63d0\u4f9b\u56db\u4e2a\u9ed8\u8ba4\u503c\u54e6\uff01\uff09\x3c/span\x3e --\x3e\n\t\t          \x3cdiv data-dojo-attach-point\x3d"enumWidgetContainerNode"\x3e\x3c/div\x3e\n\t\t        \x3c/div\x3e\n\t\t    \x3c/div\x3e\n\t\t\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cinput\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point\x3d"focusNode"\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\n/\x3e\x3c/div\x3e\n'}});
define("app/vm/Field","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-style app/util/_WidgetBase app/vm/field/FieldList app/vm/field/FieldDetail".split(" "),function(g,k,a,h,l,m,e,f){return g("app/vm/Field",[m],{templateString:"\x3cdiv \x3e\x3c/div\x3e",currentComps:null,FieldListComp:null,FieldDetailComp:null,data:null,postCreate:function(){this.inherited(arguments);this._initComps();this._initEvent()},init:function(){this._goList({panelWidgetId:"defaultView"})},_initData:function(){xhr.get(URL.metaData,
{},k.hitch(this,function(c){this.data=c;c=this.data.entites;var e={Customer:"remark fax phone area address type level derive name url industry coordinate".split(" "),Contact:"qq remark appellation fax phone address maritalStatus mobile department customer logo weibo gender name email position".split(" "),WorkRecord:["status"]};c.WorkRecord.fields.status=c.Customer.fields.status;for(var f in c)for(var g in c[f].fields)e[f]&&-1==a.indexOf(e[f],g)&&-1==a.indexOf(c[f].customFields,g)?delete c[f].fields[g]:
e[f]&&-1!==a.indexOf(c[f].customFields,g)&&(c[f].fields[g].ziDingYi=!0);this.FieldListComp.fieldData=this.data.entites;this.FieldDetailComp.enumData=this.data.enums;this.FieldListComp.init()}))},_initComps:function(){this.FieldListComp=(new e).placeAt(this.domNode);this.FieldDetailComp=new f;l.set(this.FieldDetailComp.domNode,"display","none");this.FieldDetailComp.placeAt(this.domNode)},_initEvent:function(){this.own(h(this.FieldListComp,"detail",k.hitch(this,this._goDetail)),h(this.FieldDetailComp,
"list",k.hitch(this,this._goList)))},_goDetail:function(a){k.mixin(this.FieldDetailComp,a);this.FieldDetailComp.init();l.set(this.FieldListComp.domNode,"display","none");l.set(this.FieldDetailComp.domNode,"display","")},_goList:function(a){k.mixin(this.FieldListComp,a);this._initData();l.set(this.FieldDetailComp.domNode,"display","none");l.set(this.FieldListComp.domNode,"display","")}})});
