function loadJQuery(e){if(!window.jQuery){var t=document.createElement("script");t.type="text/javascript",t.charset="utf-8",t.src=resourceHost+"js/lib/jquery.js",t.onload=t.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")e&&typeof e=="function"&&e(),t.onload=t.onreadystatechange=null},document.getElementsByTagName("head")[0].appendChild(t)}else e&&typeof e=="function"&&e()}var _protocol=window.location.protocol+"//",resourceHost=_protocol+"i.static.chanjet.com/chanjet/";"undefined"==typeof console&&(console={log:function(){}}),loadJQuery(function(){(function(e){var t=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t].push(n)},this.off=function(t,n){if(!e[t])return!1;for(var r=0,i=e[t].length;r<i;r++)if(e[t][r]==n)return e[t].splice(r,1),!0;return!1},this.emit=function(t,n){if(!e[t])return!1;for(var r=0,i=e[t].length;r<i;r++)try{e[t][r](n)}catch(s){}}},n=function(e,t){return function(){return t.apply(e,arguments)}},r=function(){var e=arguments[0];for(var t=1,i=arguments.length;t<i;t++){var s=arguments[t];for(var o in s)s[o]!==null&&s[o]!==undefined&&(s[o]instanceof jQuery?e[o]=s[o]:typeof s[o]=="object"?r(e[o],s[o]):typeof s[o]=="function"?e[o]=n(e,s[o]):e[o]=s[o])}return e},i=function(){var e="qzcvflag",t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t!=null?!0:!1},s={get:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t!=null&&i()?unescape(t[2]):null},set:function(e,t,n){n||(n=2592e3);var r=new Date;r.setTime(r.getTime()+n*1e3),document.cookie=e+"="+escape(t)+";path=/;expires="+r.toGMTString()},remove:function(e){var t=new Date(1970,1,1);document.cookie=e+"="+escape("")+";path=/;expires="+t.toGMTString()}};$.AutoComplete=function(e){var t=$(e),n,r,i=[];i.push('<div class="AutoComplete" id="ChanjetLoginNameAutoComplete">'),i.push('	<ul class="AutoComplete_ul">'),i.push('		<li hz="@qq.com"></li>'),i.push('		<li hz="@163.com"></li>'),i.push('		<li hz="@126.com"></li>'),i.push('		<li hz="@189.cn"></li>'),i.push('		<li hz="@sina.com"></li>'),i.push('		<li hz="@hotmail.com"></li>'),i.push('		<li hz="@gmail.com"></li>'),i.push('		<li hz="@139.com"></li>'),i.push("	</ul>"),i.push("</div>"),$("body").append(i.join("")),n=$("#ChanjetLoginNameAutoComplete"),n.data("elt",t),r=n.find("li:not(.AutoComplete_title)"),r.mouseover(function(){$(this).siblings().filter(".hover").removeClass("hover"),$(this).addClass("hover")}).mouseout(function(){$(this).removeClass("hover")}).mousedown(function(){n.data("elt").val($(this).text()).change(),n.hide()}),t.keyup(function(e){if(/13|38|40|116/.test(e.keyCode)||this.value=="")return!1;var t=this.value;if(t.indexOf("@")==-1)return n.hide(),!1;r.each(function(){this.innerHTML=t.replace(/\@+.*/,"")+$(this).attr("hz"),this.innerHTML.indexOf(t)>=0?$(this).show():$(this).hide()}).filter(".hover").removeClass("hover"),n.show().css({left:$(this).offset().left,top:$(this).offset().top+$(this).outerHeight(!0)-1,position:"absolute",zIndex:"99999"}),r.filter(":visible").length==0?n.hide():r.filter(":visible").eq(0).addClass("hover")}).keydown(function(e){e.keyCode==38?r.filter(".hover").prev().not(".AutoComplete_title").addClass("hover").next().removeClass("hover"):e.keyCode==40?r.filter(".hover").next().addClass("hover").prev().removeClass("hover"):e.keyCode==13&&(r.filter(".hover").mousedown(),e.preventDefault())}).focus(function(){n.data("elt",$(this))}).blur(function(){n.hide()})};var o=function(e){var t=['<div id="ChanjetLogin" style="display: none;">','<div id="ChanjetLoginBlackBord">',"</div>",'<div id="ChanjetLoginContainer">','<div class="ChanjetLoginTitle">','<span class="Title">登录畅捷通帐号</span>','<a class="CloseBtn fr"></a>',"</div>",'<div class="peak"></div>','<div class="ChanjetLoginBody">','<div class="LoginError">','<a class="LoginErrorIcon"></a>','<span class="LoginErrorMsg"></span>',"</div>",'<div class="LoginName">','<div class="Icon"></div>','<div class="clearDiv"></div>','<div class="emptyDiv" placeto="ChanjetloginNameInput">手机/邮箱</div>','<div class="inputDiv"><input class="input" id="ChanjetloginNameInput" type="text" placeholder="手机/邮箱" /></div>',"</div>",'<div class="LoginPwd">','<div class="Icon"></div>','<div class="clearDiv"></div>','<div class="emptyDiv" placeto="ChanjetloginPwdInput">6-18位密码</div>','<div class="inputDiv"><input class="input" id="ChanjetloginPwdInput" type="password" typeHidden="password" placeholder="6-18位密码" /></div>',"</div>",'<div class="LoginCode">','<div class="LoginCode1">','<div class="Icon"></div>','<div class="clearDiv"></div>','<div class="emptyDiv" placeto="ChanjetloginCodeInput">验证码</div>','<div class="inputDiv"><input class="input" id="ChanjetloginCodeInput" type="text" placeholder="验证码" /></div>',"</div>",'<div class="LoginCode2">','<img id="ChanjetloginCodeImg" class="LoginCodeImg RefreshLoginCodeImg" src="" title="点击刷新">',"</div>","</div>",'<div class="AboutPwd">','<input class="RemindPwdCheckBox" type="checkbox" checked/>','<span class="RemindPwd fl">记住密码</span>','<span class="FindPwd FindPwdA">找回密码</span>',"</div>",'<div class="LoginBtn">登录</div>','<div class="AboutRegister">','<span class="RegisterUser">立即注册</span>',"</div>",'<div class="OtherLoginWayLine"></div>','<div class="OtherLoginWay">','<div class="OtherLoginWayText">可以使用以下方式登录</div>',"<div>",'<div class="OtherLoginWayIcon QQ"></div>','<div class="OtherLoginWayIcon weixin"></div>','<div class="OtherLoginWayIcon weibo"></div>','<div class="clear">',"</div>","</div>",'<div class="clear"></div>',"</div>",'<div class="clear"></div>',"</div>","</div>","</div>"].join(""),n="ChanjetLogin",r="ChanjetLoginContainer",i="ChanjetLoginBlackBord",o=_protocol+"i.chanjet.com/",a=390,f=485,l=50,c=85,h=!1,p="",d=!1,v="",m="",g=0,y="qzcvflag",b="nvf",w="#ChanjetloginCodeInput";if(window.location.host=="i.chanjet.com"||window.location.host=="www.chanapp.com")o=_protocol+window.location.host+"/";var E=function(){S(),C()},S=function(){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=resourceHost+"css/login/ChanjetLogin.css",document.getElementsByTagName("head")[0].appendChild(i);var s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.src=resourceHost+"js/lib/md5.js",document.getElementsByTagName("head")[0].appendChild(s);var o=f-l;e.needOtherLogin.QQ||e.needOtherLogin.weixin||e.needOtherLogin.weibo||(o-=c);var u,h;e.parentNode[0]==$("body")[0]?(u=$(window).width(),h=$(window).height()):(u=e.parentNode.width(),h=e.parentNode.height());var p=(h-o)/2,d=(u-a)/2;p=p>0?p:0,d=d>0?d:0,e.parentNode[0].appendChild($(t)[0]),$("#"+r).css("width",a+"px").css("height",o+"px").css("top",p+"px").css("left",d+"px");if(e.needOtherLogin.QQ||e.needOtherLogin.weixin||e.needOtherLogin.weibo){if(e.needOtherLogin.QQ){var v="#ChanjetLoginContainer .QQ";$(v).css("display","block")}e.needOtherLogin.weixin=!1,e.needOtherLogin.weibo=!1;if(e.needOtherLogin.weixin){var m="#ChanjetLoginContainer .weixin";$(m).css("display","block")}if(e.needOtherLogin.weibo){var g="#ChanjetLoginContainer .weibo";$(g).css("display","block")}}else{var y="#"+n+" .OtherLoginWayLine",b="#"+n+" .OtherLoginWay";$(y).hide(),$(b).hide()}if(!e.CanBeClose){var w="#"+n+" .CloseBtn";$(w).hide()}},x=function(){$("#"+n+" .LoginCode").show(),$("#ChanjetloginCodeImg").attr("src",o+"authImageCode?"+(new Date).getTime()),Z("")},T=function(){if(s.get("mabjcldwplen")&&s.get("mabjcldwp")){var e=parseInt(s.get("mabjcldwplen")),t="";for(var n=0;n<e;++n)t+="*";G(t),d=!0,v=s.get("mabjcldwp").split("").reverse().join("")}},N=function(){console.log("initFill username and password"),e.userName&&e.userName!=""?(V(e.userName),s.get("mabjcluid")&&s.get("mabjcluid")==e.userName?T():G("")):s.get("mabjcluid")?(V(s.get("mabjcluid")),T()):(V(""),G(""))},C=function(){$("#"+n).delegate(".RefreshLoginCodeImg","click",function(){return x(),$(w).focus()}).delegate(".CloseBtn","click",function(){nt()}).delegate(".RemindPwd","click",function(){var e="#"+n+" .RemindPwdCheckBox",t=$(e)[0].checked;t?$(e)[0].checked=!1:$(e)[0].checked=!0}).delegate(".QQ","click",function(){u(function(t){var n=_protocol+"openapi.qzone.qq.com/oauth/show?which=Login&display=pc&response_type=code&client_id=101005512&redirect_uri=",r=o+"login/thirdLogin?authcode="+t.auth_code+"&platform=qq&client_id=kjjy&redirect="+e.needOtherLogin.redirectUrl;window.location.href=n+encodeURIComponent(r)})}).delegate(".FindPwdA","click",function(){var e=k();e.length>0?e+="&uid="+X():e="?uid="+X(),window.open(o+"login/forget"+e)}).delegate(".RegisterUser","click",function(){if(e.needRegister){var t=X()!=""?"account="+X():"";window.open(o+"register/register?"+t)}else nt()}).delegate(".emailA","click",function(){window.open($(this).attr("emailrel"))}).delegate(".LoginName>.clearDiv","click",function(){var e="#"+n+" .LoginName>.inputDiv>input";$(e).val("").focus()}).delegate(".LoginPwd>.clearDiv","click",function(){var e="#"+n+" .LoginPwd>.inputDiv>input";$(e).val("").focus()}).delegate(".LoginCode1>.clearDiv","click",function(){$(w).val("").focus()}).delegate(".LoginCode1>.inputDiv>input","focus",function(e){F(),W()}).delegate(".LoginCode1>.inputDiv>input","blur",function(e){A()}).delegate(".LoginCode1>.inputDiv>input","keydown",function(e){if(e.keyCode==13&&Y()!=""){$(w).blur();var t="#"+n+" .LoginBtn";$(t).trigger("click")}}).delegate(".LoginPwd>.inputDiv>input","focus",function(e){F(),q()}).delegate(".LoginPwd>.inputDiv>input","blur",function(e){M()}).delegate(".LoginPwd>.clearDiv","click",function(e){d=!1,F(),q()}).delegate(".LoginPwd>.inputDiv>input","keydown",function(e){if(e.keyCode==13)if(h)$(w).focus();else{var t="#"+n+" .LoginPwd>.inputDiv>input";$(t).blur();var r="#"+n+" .LoginBtn";$(r).trigger("click")}else d=!1}).delegate(".LoginName>.inputDiv>input","focus",function(e){F(),U()}).delegate(".LoginName>.inputDiv>input","blur",function(e){O()}).delegate(".LoginName>.inputDiv>input","keydown",function(e){if(e.keyCode==13){var t="#"+n+" .LoginPwd>.inputDiv>input";$(t).focus()}}).delegate(".LoginName>.clearDiv","click",function(e){F(),U()}).delegate(".LoginBtn","click",function(e){P()}),$.AutoComplete("#ChanjetloginNameInput"),$(window).resize(function(){var t=$("#"+r),n=t.height(),i=t.width(),s,o;e.parentNode[0]==$("body")[0]?(s=$(window).width(),o=$(window).height()):(s=e.parentNode.width(),o=e.parentNode.height());var u=(o-n)/2,f=(s-i)/2;u=u>0?u:0,f=f>0?f:0,t.css("width",a+"px").css("height",n+"px").css("top",u+"px").css("left",f+"px")}),"placeholder"in document.createElement("input")?$(".emptyDiv").hide():(console.log("不支持placeholder -- chanjetLogin"),$(".emptyDiv").show(),$(".emptyDiv").click(function(){var e=$(this).attr("placeto");$(this).hide(),$("#"+e).focus()}),$("[placeholder]").focus(function(){var e=$(this);if(e.val()==""){var t="[placeto='"+e.attr("id")+"']";$(t).hide()}}).blur(function(){var e=$(this);if(e.val()==""){var t="[placeto='"+e.attr("id")+"']";$(t).show()}}).blur())},k=function(){return window.location.search},L=function(e){var t=Y();if(e>=65&&e<=90||e>=48&&e<=57)return t.length>=4?!1:!0;if(e==8)return!0;if(e!=13)return!1;var r="#"+n+" .LoginBtn";$(r).trigger("click")},A=function(){var e=Y();return h&&e==""?(j("请输入验证码"),z(),!1):(F(),W(),!0)},O=function(){return F(),U(),!0},M=function(){var e=J().length;return e<6&&e>0?(j("密码不能小于6位"),I(),!1):e>18&&!d?(j("密码不能大于18位"),I(),!1):(F(),q(),!0)},_=function(){var e=X().length,t=J().length;return e==0&&t==0?(j("请输入手机/邮箱"),R(),I(),!1):e==0?(j("请输入手机/邮箱"),R(),!1):t==0?(j("请输入6-18位密码"),I(),!1):(F(),U(),q(),!0)},D=this,P=function(){_()&&O()&&M()&&A()&&u(function(t){var n={auth_username:X(),password:Q(),auth_code:t.auth_code,authImage:Y(),jsonp:"1"};$.ajax({url:o+"login/webLogin",type:"POST",data:n,dataType:"jsonp",success:function(t){if(t.result){t.account=X(),H(X(),Q(),K());if(t.intoFinanceDirectly){location.href="http://e.uu.com.cn";return}e.loginSuccess&&typeof e.loginSuccess=="function"&&e.loginSuccess(t),tt(),g=0,nt()}else B(t)},error:function(e){B(e)}})},function(e){D.emit("jsonpLoginSuccess",{code:e})})},H=function(e,t,r){var i="#"+n+" .RemindPwdCheckBox",o=$(i)[0].checked;o?(s.set("mabjcluid",e),s.set("mabjcldwp",t.split("").reverse().join("")),s.set("mabjcldwplen",r),s.set(y,b)):(s.remove("mabjcluid"),s.remove("mabjcldwp"),s.remove("mabjcldwplen"),s.remove(y),s.set("mabjcluid",e))},B=function(e){g++;if(e.errorCode=="authImage")j("验证码错误");else if(e.errorCode=="20129")j("帐号或密码错误，<a class='errorA FindPwdA'>找回密码？</a>");else if(e.errorCode=="20024")j("帐号被锁定，请15分钟后再试");else if(e.errorCode=="20119")j("帐号不存在，去<a class='errorA RegisterUser'>注册</a>");else if(e.errorCode=="20130"){var t=X(),n=t.substr(t.indexOf("@")+1),r="";if(window.APP)for(var i in APP.email)i==n&&(r=APP.email[i]);r==""?j("账户未激活，请登录邮箱激活"):(r=_protocol+r,j("账户未激活，<a class='errorA emailA' emailrel = '"+r+"'>去邮箱激活？</a>"))}else j(decodeURI(e.errorMessage));if(e.needAuthImage||g>=3)h=!0,needAuthImage=!0,x(),et()},j=function(e){var t="#"+n+" .LoginError";$(t).html(e)},F=function(){var e="#"+n+" .LoginError";$(e).html("")},I=function(){var e="#"+n+" .LoginPwd>.inputDiv>input";$(e).css("border-color","#ff0000")},q=function(){var e="#"+n+" .LoginPwd>.inputDiv>input";$(e).css("border-color","#dbdbdb")},R=function(){var e="#"+n+" .LoginName>.inputDiv>input";$(e).css("border-color","#ff0000")},U=function(){var e="#"+n+" .LoginName>.inputDiv>input";$(e).css("border-color","#dbdbdb")},z=function(){$(w).css("border-color","#ff0000")},W=function(){$(w).css("border-color","#dbdbdb")},X=function(){var e="#"+n+" .LoginName>.inputDiv>input";return $.trim($(e).val())},V=function(e){var t="#"+n+" .LoginName>.inputDiv>input",r="#"+n+" .LoginName>.emptyDiv",i="#"+n+" .LoginName>.clearDiv";e!=""&&$(r).hide(),$(t).val(e),$(t).change()},J=function(){var e="#"+n+" .LoginPwd>.inputDiv>input";return d?v:$(e).val()},K=function(){var e="#"+n+" .LoginPwd>.inputDiv>input";return d?s.get("mabjcldwplen"):$(e).val().length},Q=function(){var e="#"+n+" .LoginPwd>.inputDiv>input";return d?v:faultylabs.MD5(J()).toLowerCase()},G=function(e){var t="#"+n+" .LoginPwd>.inputDiv>input",r="#"+n+" .LoginPwd>.emptyDiv",i="#"+n+" .LoginPwd>.clearDiv";e!=""&&$(r).hide(),$(t).val(e),$(t).change()},Y=function(){return $(w).val()},Z=function(e){var t="#"+n+" .LoginCode1>.clearDiv";$(w).val(e),$(w).change()},et=function(){var t=f;$("#"+n+" .LoginCode").is(":hidden")&&(t-=l),e.needOtherLogin||(t-=c),$("#"+r).css("height",t+"px")},tt=function(){if(!d){var e=J(),t=new RegExp("^(((?=.*[A-Z_])(?=.*[a-z])(?=.*[0-9])(?=.*\\W))|((?=.*\\W)(?=.*[a-z_])(?=.*[0-9]))|((?=.*[A-Z_])(?=.*\\W)(?=.*[0-9]))|((?=.*[A-Z_])(?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z_])(?=.*[a-z])(?=.*\\W))).*$","g"),n=new RegExp("^(((?=.*[0-9])(?=.*[a-z_]))|((?=.*[A-Z_])(?=.*[0-9]))|((?=.*[A-Z_])(?=.*[a-z]))|((?=.*[0-9_])(?=.*\\W))|((?=.*[A-Z_])(?=.*\\W))|((?=.*[a-z_])(?=.*\\W))).*$","g");strongLevel=1,e.length>=8&&n.test(e)?strongLevel=2:e.length>=8&&t.test(e)&&(strongLevel=3),$.ajax({url:o+"/useraccount/queryPwdSecuLevel",type:"get",data:null,dataType:"jsonp",success:function(e){strongLevel!=e.passwordLevel&&$.ajax({url:o+"/useraccount/changePassword",type:"get",data:{oldPassword:Q(),password:Q(),passwordLevel:strongLevel},dataType:"jsonp",success:function(){},error:function(){}})},error:function(){}})}},nt=function(){$("#"+n).hide()},rt=function(){var e,t,n,r,i,s={},o=window.location.pathname,u=window.location.href;if(u.indexOf("?")>-1){var a=u.indexOf("?");n=u.substring(a+1),n=n.split("&"),t=n.length;for(e=0;e<t;e++){var f=n[e].indexOf("=");r=n[e].substring(0,f),i=n[e].substring(f+1)||"",r=="callback"&&(i=decodeURIComponent(i)),s[r]=i}}return o.indexOf("/tplus/")>-1&&(o=="/tplus/onlylogin"?s.app="tplusOnly":s.app="tplus"),s},it=function(){N(),F(),q(),U(),W()};this.show=function(){var e=this;u(function(e){it(),$("#"+n).show(),window.needAuthImage&&(console.log("need image code"),x(),et())},function(t){console.log("已经是登录状态了哦！"),e.emit("jsonpLoginSuccess",{code:t})})},this.setUserName=function(t){t!=""&&(e.userName=t,N())},E()},u=function(e,t){$.ajax({url:_protocol+"cia.chanapp.chanjet.com/internal_api/authorizeByJsonp?client_id=chanjetapp",type:"GET",dataType:"jsonp",data:{jsonp:!0},success:function(n){console.log("cia jsonp:",n),n.code?t&&t(n.code):n.auth_code&&(authCode=n.auth_code,e&&e(n))}})},a=null,f={parentNode:$("body"),needOtherLogin:{QQ:!0,weixin:!1,weibo:!1,redirectUrl:_protocol+"i.chanjet.com"},CanBeClose:!0,registerCallback:null,findPwdCallback:null,needRegister:!0};o.prototype.getInstance=function(e){return e=e||{},f.parentNode.length==0&&(f.parentNode=$("body")),o.prototype=r(o.prototype,new t),a instanceof o||(e.parentNodeId&&e.parentNodeId!=""&&$("#"+e.parentNodeId).length>0&&(e.parentNode=$("#"+e.parentNodeId)),r(f,e),a=new o(f)),u(function(e){a.emit("jsonpCallback",{auth_code:e})},function(e){console.log("已经是登录状态了哦！"),a.emit("jsonpCallback",{code:e})}),a};var l={getInstance:o.prototype.getInstance};e.ChanjetLogin=l;if("function"!=typeof define||!define.amd)return l;define([],function(){return l})})(typeof window!="undefined"?window:this)});